// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace augusto.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using augusto;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/Users/augusto/Documents/projeto_blazor/_Imports.razor"
using augusto.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/augusto/Documents/projeto_blazor/Pages/PagCliente.razor"
using System.Text.RegularExpressions;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/PagCliente")]
    public partial class PagCliente : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 201 "/Users/augusto/Documents/projeto_blazor/Pages/PagCliente.razor"
       
  // CHAMADAS JAVASCRIPT
  public string MostraMensagem = "none";
  private IList<Cliente> Clientes = new List<Cliente>();

  private Cliente cliente = new Cliente();

  protected override async Task OnAfterRenderAsync(bool firstRender)
  {
    if (firstRender)
    {
      JS.InvokeAsync<string>("LoadPage","");
      StateHasChanged();
    }
  }

  private void CarregaClientes()
  {
    Clientes = new ClienteDAO().PegarClientes();
  }

  protected override async Task OnInitializedAsync()
  {
    Clientes = new ClienteDAO().PegarClientes();
  }
  protected async Task ExcluirCliente(Cliente cli)
  {
    JS.InvokeAsync<string>("ShowModal", "ModalExcluir");
    cliente = cli;
    //new ClienteDAO().ExcluirCliente(cli);
    //CarregaClientes();
  }

  public void ConfirmarExclusao()
  {
    if (cliente != null)
    {
      new ClienteDAO().ExcluirCliente(cliente);
      CarregaClientes();
    }
    JS.InvokeAsync<string>("HideModal", "ModalExcluir");
    cliente = new Cliente();
  }

  public void CancelarExclusao()
  {
    cliente = new Cliente();
    JS.InvokeAsync<string>("HideModal", "ModalExcluir");

  }
  protected async Task SelecionarCliente(Cliente cli)
  {
    cliente = cli;
    JS.InvokeAsync<string>("ShowTab", "tabForm");
  }
  public void GravarCliente()
  {
    if (string.IsNullOrEmpty(cliente.nome) ||
    string.IsNullOrEmpty(cliente.e_mail) ||
    string.IsNullOrEmpty(cliente.CPF) ||
    string.IsNullOrEmpty(cliente.CEP))
    {
      MostraMensagem = "block";
    }
    else
    {
      bool Validado = true;
      // Validar e-mail :
      if (string.IsNullOrEmpty(cliente.e_mail))
      {
        Regex regex = new Regex(@"^([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)$");
        Match match = regex.Match(cliente.e_mail);
        if (!match.Success) // = false
        {
          JS.InvokeAsync<String>("ShowModal", "ModalCamposObrigatadrios");
          Validado = false;
        }
      }
      if (Validado)
      {
        if (cliente.id_Cliente > 0)
        {
          new ClienteDAO().AtualizarCliente(cliente);
        }
        else
        {
          cliente.data_hora_Entrada = DateTime.Now;
        }
      }
      if (cliente.id_Cliente > 0)
      {
        new ClienteDAO().AtualizarCliente(cliente);
      }
      else
      {
        cliente.data_hora_Entrada = DateTime.Now;
        new ClienteDAO().InserirCliente(cliente);

      }

      cliente = new Cliente();
      CarregaClientes();
      JS.InvokeAsync<string>("ShowTab", "tabLista");

    }

  }

  public void BotaoCancelar()
  {
    cliente = new Cliente();
    JS.InvokeAsync<string>("ShowTab", "tabLista");
  }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JS { get; set; }
    }
}
#pragma warning restore 1591
